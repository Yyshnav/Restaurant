{% extends 'sidebar.html' %}
{% load static %}


{% block body %}
  <style>
    .table th, .table td { vertical-align: middle; }
    .action-buttons button { margin-right: 5px; }
    .view-section {
      max-width: 1000px;
      margin: 30px auto;
    }
  </style>
</head>



<!-- Content -->
<div class="app-content content">
  <div class="content-wrapper">
    <div class="content-body">
      <div class="container-fluid">
        <div class="card p-3 view-section  ">
            <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="mb-0">Available Coupons</h4>
        <a href="/add-coupon" class="btn btn-primary">
          <i class="fa fa-plus mr-1"></i> Add Coupon
        </a>
      </div>
          <table class="table table-bordered table-striped">
            <thead class="bg-gradient-x-purple-blue text-white">
              <tr>
                <th>#</th>
                <th>Code</th>
                <th>Discount</th>
                <th>Min Order</th>
                <th>Expiry</th>
                <th>Description</th>
                <th>Actions</th>
              </tr>
            </thead>
           <tbody>
              {% for coupon in coupons %}
                <tr>
                  <td>{{ forloop.counter }}</td>
                  <td>{{ coupon.code }}</td>

                  <td>
                    {% if coupon.discount_percentage %}
                      {{ coupon.discount_percentage }}%
                    {% elif coupon.max_discount_amount %}
                      ₹{{ coupon.max_discount_amount }}
                    {% else %}
                      -
                    {% endif %}
                  </td>

                  <td>
                    {% if coupon.min_order_amount %}
                      ₹{{ coupon.min_order_amount }}
                    {% else %}
                      -
                    {% endif %}
                  </td>

                  <td>{{ coupon.valid_to|default:"-" }}</td>
                  <td>{{ coupon.description|default:"-" }}</td>

                  <td class="action-buttons">
                    <button onclick="window.location='/edit-coupon/{{ coupon.id }}/'" class="btn btn-sm btn-info"><i class="fa fa-edit"></i></button>
                    <button onclick="window.location='/delete-coupon/{{ coupon.id }}'" class="btn btn-sm btn-danger"><i class="fa fa-trash-alt"></i></button>
                  </td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan="7" class="text-center">No coupons available.</td>
                </tr>
              {% endfor %}
            </tbody>

          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->

<script>


  const tbody = document.getElementById('couponTableBody');

  coupons.forEach((coupon, index) => {
    const row = document.createElement('tr');
    row.innerHTML = `
      <td>${index + 1}</td>
      <td>${coupon.code}</td>
      <td>${coupon.discount}%</td>
      <td>$${coupon.minOrder}</td>
      <td>${coupon.expiry}</td>
      <td>${coupon.description || '-'}</td>
      <td class="action-buttons">
        <button class="btn btn-sm btn-info"><i class="fa fa-edit"></i></button>
        <button class="btn btn-sm btn-danger"><i class="fa fa-trash-alt"></i></button>
      </td>
    `;
    tbody.appendChild(row);
  });
</script>

{% endblock %}
